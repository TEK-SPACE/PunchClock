<ul class="nav navbar-nav">

    @foreach (var item in (IEnumerable<PunchClock.Domain.Model.SiteMap>)ViewBag.Menu)
    {
        if (item.IsUserAccessable && item.IsMenuItem && item.Children.Any())
        {
            <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes"> @item.Name <span class="caret"></span></a>
                <ul class="dropdown-menu" aria-labelledby="themes">
                    @foreach (var child in item.Children)
                    {
                        if (child.IsUserAccessable && child.IsMenuItem)
                        {
                            <li>
                                @Html.ActionLink(child.Name, child.Action, child.Controller, null, null)
                            </li>
                        }
                    }
                </ul>
            </li>
        }
        else if (item.IsUserAccessable && item.IsMenuItem)
        {
            <li>
                @Html.ActionLink(item.Name, item.Action, item.Controller, null, null)
            </li>
        }
    }
</ul>